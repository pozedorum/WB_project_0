# Order Information Service

Проект предоставляет сервис, получающий заказы через брокер сообщений Kafka, и веб-интерфейс для просмотра информации о заказах через ID.

### Требования
- Docker
- Docker Compose

### Инструкция по запуску

1. Клонируйте репозиторий:
   ```bash
   git clone <https://github.com/pozedorum/WB_project_0.git>
   cd <WB_project_0>
   ```

2. Запустите сервисы(если возникает ошибка, ctrl+c и заново запустить):
   ```bash
   make up
   ```
2.2 Дождитесь вывода в терминал сообщений вида `producer-1 | 2025/07/02 11:20:35 Sent order: test123`
3. Откройте в браузере:
   ```
   http://localhost:8081
   ```

### Использование
1. Введите ID заказа (например, `test123`)
2. Нажмите "Get Order"
3. Просмотрите информацию о заказе

### Тестовые данные
Система автоматически создает тестовый новый заказ каждые 10 секунд после запуска.

### Остановка
```bash
Сtrl+c -- Для остановки сервиса
make down -- Для удаления данных сервиса из контейнера
```

```markdown
# Структура проекта WB_project_0

## Основные директории и файлы

```
.
├── cmd
│   ├── producer/          # Сервис-продюсер Kafka
│   └── server/            # Точка запуска приложения
├── config/                # Конфигурационные файлы
│   ├── config.go          # Получение конфига
│   └── config.txt         # Текстовый конфиг
├── internal/              # Внутренние модули приложения
│   ├── cache/             # Кэширование данных
│   ├── db/                # Работа с базой данных
│   ├── frontend/          # Фронтенд часть
│   ├── models/            # Модели данных
│   ├── server/            # Серверная логика
│   ├── migrations/        # Скрипты базы данных
├── pkg                    # Дополнительный модули приложения
│   └── logger/            # Логирование
├── Makefile               # Автоматизация задач
├── go.mod                 # Модули Go
├── go.sum                 # Зависимости Go
├── docker-compose.yml     # Конфигурация Docker Compose
├── Dockerfile             # Основной Dockerfile
├── Dockerfile.db-test     # Dockerfile для тестов БД (от тестов пришлось отказаться, так как они мешали запуску, оставил просто, чтобы было видно, что тесты писал)
├── Dockerfile.producer    # Dockerfile для продюсера
└── README.md              # Документация проекта
```

## Подробное описание компонентов

### 1. Основные сервисы

**producer/**
- Сервис для отправки сообщений в Kafka
- Содержит логику генерации тестовых данных

**server/**
- Основной сервер приложения
- Обрабатывает HTTP-запросы
- Интегрируется с БД и Kafka

### 2. Конфигурация

**config/**
- `config.go` - структуры и методы для работы с конфигурацией
- `config.txt` - параметры конфигурации в текстовом формате

### 3. Внутренние модули (internal/)

**cache/**
- Реализация кэширования данных
- Содержит все взаимодействия сервера с базой

**db/**
- Подключение к PostgreSQL
- Запросы к базе данных

**frontend/**
- Шаблоны и статические файлы
- Обработка веб-интерфейса

**models/**
- Определение структур данных:
  - Order
  - Delivery
  - Payment
  - Item

**server/**
- Запуск сервера
- HTTP-обработчики
- Маршрутизация

### 4. Инфраструктура

**docker-compose.yml**
- Сервисы:
  - PostgreSQL
  - Kafka + Zookeeper
  - Основное приложение
  - Продюсер

**Dockerfile**
- Сборка основного приложения
- Многоэтапная сборка

**Makefile**
- Команды для:
  - Сборки
  - Тестирования
  - Запуска

## Зависимости

Основные внешние зависимости:
- PostgreSQL драйвер
- Kafka клиент (segmentio/kafka-go)
- HTTP роутер (http/mux)

## Запуск проекта

```bash
# Сборка и запуск
make up

# Остановка
Ctrl+c


# Пересоздание с очисткой томов
make down
make up
```

Порт: 8081    `http://localhost:8081/`
API endpoint: `/api/orders/{order_id}`